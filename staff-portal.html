<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Portal | EnRICH</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300;400;600;700&amp;family=Merriweather:wght@400;700&amp;display=swap" rel="stylesheet">
    <style>
        :root { --enrich-purple: #8B2A7D; --enrich-purple-dark: #6B1F5F; --enrich-blue: #2D7BC4; --enrich-blue-dark: #1E5A94; --enrich-blue-light: #4A9AE8; --enrich-navy: #1E3A5F; --enrich-teal: #2A6575; --white: #FFFFFF; --off-white: #F8F9FA; --light-gray: #E9ECEF; --text-gray: #495057; --shadow: 0 4px 20px rgba(30, 58, 95, 0.15); --shadow-hover: 0 8px 30px rgba(30, 58, 95, 0.25); }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Source Sans Pro', -apple-system, BlinkMacSystemFont, sans-serif; background: var(--off-white); color: var(--enrich-navy); line-height: 1.6; }
        header { background: linear-gradient(135deg, var(--enrich-purple) 0%, var(--enrich-purple-dark) 100%); color: var(--white); position: sticky; top: 0; z-index: 1000; box-shadow: var(--shadow); }
        .header-content { max-width: 1200px; margin: 0 auto; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }
        .logo-section { display: flex; align-items: center; gap: 1rem; text-decoration: none; color: var(--white); }
        .logo-section img { height: 60px; width: auto; background: white; border-radius: 8px; padding: 4px; }
        .logo-text h1 { font-family: 'Merriweather', Georgia, serif; font-size: 1.5rem; font-weight: 700; }
        .logo-text p { font-size: 0.85rem; opacity: 0.9; font-weight: 300; }
        nav { display: flex; gap: 0.5rem; flex-wrap: wrap; }
        nav a { background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3); color: var(--white); padding: 0.6rem 1.2rem; border-radius: 6px; font-family: inherit; font-size: 0.9rem; font-weight: 600; transition: all 0.3s ease; text-decoration: none; }
        nav a:hover, nav a.active { background: var(--white); color: var(--enrich-purple); }
        nav a.pin-link { border-color: rgba(255,255,255,0.5); }
        .nhs-banner { background: var(--enrich-blue); color: var(--white); text-align: center; padding: 0.5rem; font-size: 0.85rem; }
        main { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        .pin-section { max-width: 500px; margin: 0 auto; text-align: center; }
        .pin-box { background: var(--white); border-radius: 16px; padding: 3rem 2rem; box-shadow: var(--shadow); margin-top: 2rem; }
        .pin-box h2 { font-family: 'Merriweather', Georgia, serif; color: var(--enrich-purple); margin-bottom: 1rem; }
        .pin-box p { color: var(--text-gray); margin-bottom: 1.5rem; }
        .pin-input-container { display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 1.5rem; }
        .pin-digit { width: 55px; height: 65px; font-size: 1.8rem; text-align: center; border: 2px solid var(--light-gray); border-radius: 10px; font-family: 'Source Sans Pro', sans-serif; font-weight: 600; color: var(--enrich-navy); transition: all 0.2s ease; }
        .pin-digit:focus { border-color: var(--enrich-purple); outline: none; box-shadow: 0 0 0 3px rgba(139, 42, 125, 0.2); }
        .btn { background: linear-gradient(135deg, var(--enrich-purple) 0%, var(--enrich-purple-dark) 100%); color: var(--white); border: none; padding: 1rem 2.5rem; font-size: 1rem; font-weight: 600; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-family: inherit; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(139, 42, 125, 0.4); }
        .error-message { color: #dc3545; margin-top: 1rem; font-weight: 600; display: none; }
        .portal-content { display: none; }
        .portal-header { background: linear-gradient(135deg, var(--enrich-navy) 0%, var(--enrich-teal) 100%); color: var(--white); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; text-align: center; }
        .portal-header h2 { font-family: 'Merriweather', Georgia, serif; font-size: 1.8rem; margin-bottom: 0.5rem; border: none; padding: 0; color: var(--white); display: block; }
        .portal-header p { opacity: 0.9; }
        .portal-header .auth-badge { display: inline-block; background: rgba(255,255,255,0.2); padding: 0.4rem 1rem; border-radius: 20px; font-size: 0.85rem; margin-top: 0.75rem; }
        .portal-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin: 2rem 0; }
        .portal-card { background: var(--white); border-radius: 12px; padding: 2rem; box-shadow: var(--shadow); text-decoration: none; color: inherit; transition: all 0.3s ease; border-left: 4px solid var(--enrich-purple); display: block; }
        .portal-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-hover); }
        .portal-card.blue { border-left-color: var(--enrich-blue); }
        .portal-card.teal { border-left-color: var(--enrich-teal); }
        .portal-card-icon { font-size: 2rem; margin-bottom: 0.75rem; }
        .portal-card h3 { font-family: 'Merriweather', Georgia, serif; color: var(--enrich-purple); margin-bottom: 0.5rem; font-size: 1.15rem; }
        .portal-card.blue h3 { color: var(--enrich-blue); }
        .portal-card.teal h3 { color: var(--enrich-teal); }
        .portal-card p { color: var(--text-gray); font-size: 0.9rem; margin-bottom: 0.75rem; }
        .portal-card ul { color: var(--text-gray); font-size: 0.85rem; margin-left: 1.2rem; }
        .portal-card li { margin-bottom: 0.3rem; }
        .portal-card .arrow { display: block; margin-top: 1rem; color: var(--enrich-purple); font-weight: 600; font-size: 0.9rem; }
        .portal-card.blue .arrow { color: var(--enrich-blue); }
        .portal-card.teal .arrow { color: var(--enrich-teal); }
        .quick-links { background: var(--white); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow); margin-top: 2rem; }
        .quick-links h3 { font-family: 'Merriweather', Georgia, serif; color: var(--enrich-navy); margin-bottom: 1rem; font-size: 1.1rem; }
        .quick-links-grid { display: flex; flex-wrap: wrap; gap: 0.75rem; }
        .quick-link { display: inline-block; background: linear-gradient(135deg, rgba(139,42,125,0.08) 0%, rgba(45,123,196,0.08) 100%); padding: 0.6rem 1.2rem; border-radius: 8px; text-decoration: none; color: var(--enrich-navy); font-weight: 600; font-size: 0.9rem; transition: all 0.2s ease; }
        .quick-link:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(30, 58, 95, 0.15); }
        .logout-section { text-align: center; margin-top: 2rem; }
        .logout-btn { background: transparent; border: 2px solid #dc3545; color: #dc3545; padding: 0.5rem 1.5rem; font-size: 0.85rem; font-weight: 600; border-radius: 6px; cursor: pointer; transition: all 0.3s ease; font-family: inherit; }
        .logout-btn:hover { background: #dc3545; color: white; }
        footer { background: var(--enrich-navy); color: var(--white); padding: 2rem; margin-top: 3rem; }
        .footer-content { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }
        .footer-content p { opacity: 0.9; font-size: 0.9rem; }
        .footer-content a { color: var(--enrich-blue-light); }
        @media (max-width: 768px) {
            .header-content { flex-direction: column; text-align: center; padding: 1rem; }
            .logo-section { flex-direction: column; gap: 0.5rem; }
            .logo-section img { height: 50px; }
            .logo-text h1 { font-size: 1.3rem; }
            nav { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; scrollbar-width: none; justify-content: flex-start; padding-bottom: 5px; }
            nav::-webkit-scrollbar { display: none; }
            nav a { flex-shrink: 0; padding: 0.6rem 1rem; font-size: 0.85rem; min-height: 44px; display: flex; align-items: center; }
            main { padding: 1rem; }
            .pin-box { padding: 1.5rem 1rem; }
            .pin-input-container { gap: 8px; }
            .pin-digit { width: 48px; height: 58px; font-size: 1.5rem; }
            .portal-grid { grid-template-columns: 1fr; }
            .footer-content { flex-direction: column; text-align: center; }
        }
        @media (max-width: 380px) { .pin-digit { width: 42px; height: 52px; font-size: 1.3rem; } }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="index.html" class="logo-section">
                <img src="EnRICH_Logo_solid.png" alt="EnRICH Logo">
                <div class="logo-text"><h1>EnRICH</h1><p>Enhanced Reviews in Care Homes</p></div>
            </a>
            <nav>
                <a href="index.html">Home</a>
                <a href="about.html">About EnRICH</a>
                <a href="services.html">Our Services</a>
                <a href="resources.html">Resources</a>
                <a href="team.html" class="pin-link">&#x1F512; Meet the Team</a>
                <a href="referral.html" class="pin-link">&#x1F512; Make a Referral</a>
                <a href="staff-portal.html" class="active pin-link">&#x1F512; Staff Portal</a>
            </nav>
        </div>
    </header>
    <div class="nhs-banner">A service provided by <strong>Cambridge University Hospitals NHS Foundation Trust</strong> &amp; <strong>Cambridgeshire &amp; Peterborough NHS Foundation Trust</strong></div>

    <main>
        <div class="pin-section" id="pin-entry">
            <div class="pin-box">
                <h2>&#x1F512; Staff Portal</h2>
                <p>Enter your 5-digit care home PIN code to access staff resources, policies, timetables, and contact information.</p>
                <div class="pin-input-container">
                    <input type="text" class="pin-digit" maxlength="1" data-index="0" inputmode="numeric" pattern="[0-9]*" aria-label="PIN digit 1">
                    <input type="text" class="pin-digit" maxlength="1" data-index="1" inputmode="numeric" pattern="[0-9]*" aria-label="PIN digit 2">
                    <input type="text" class="pin-digit" maxlength="1" data-index="2" inputmode="numeric" pattern="[0-9]*" aria-label="PIN digit 3">
                    <input type="text" class="pin-digit" maxlength="1" data-index="3" inputmode="numeric" pattern="[0-9]*" aria-label="PIN digit 4">
                    <input type="text" class="pin-digit" maxlength="1" data-index="4" inputmode="numeric" pattern="[0-9]*" aria-label="PIN digit 5">
                </div>
                <button class="btn" id="validate-btn">Access Staff Portal</button>
                <p class="error-message" id="pin-error">Invalid PIN code. Please check and try again.</p>
            </div>
        </div>

        <div class="portal-content" id="portal-content">
            <div class="portal-header">
                <h2>EnRICH Staff Portal</h2>
                <p>Resources for care home staff and healthcare professionals</p>
                <div class="auth-badge">&#x2705; Authenticated &mdash; <span id="care-home-name"></span></div>
            </div>

            <div class="portal-grid">
                <a href="portal-policies.html" class="portal-card">
                    <div class="portal-card-icon">&#x1F4CB;</div>
                    <h3>Policies &amp; Guidelines</h3>
                    <p>Clinical policies, care pathways, and evidence-based guidelines for care home staff.</p>
                    <ul>
                        <li>EnRICH clinical protocols</li>
                        <li>Escalation pathways</li>
                        <li>Medication management guidelines</li>
                        <li>Falls prevention policies</li>
                    </ul>
                    <span class="arrow">View policies &rarr;</span>
                </a>

                <a href="portal-timetables.html" class="portal-card blue">
                    <div class="portal-card-icon">&#x1F4C5;</div>
                    <h3>Timetables &amp; Schedules</h3>
                    <p>Visit schedules, MDT meeting times, and service availability.</p>
                    <ul>
                        <li>Care home visit schedule</li>
                        <li>MDT meeting timetable</li>
                        <li>On-call availability</li>
                        <li>Education session dates</li>
                    </ul>
                    <span class="arrow">View timetables &rarr;</span>
                </a>

                <a href="portal-gp-contacts.html" class="portal-card teal">
                    <div class="portal-card-icon">&#x1F4DE;</div>
                    <h3>GP Practice Contacts</h3>
                    <p>Contact numbers and details for GP practices serving enrolled care homes.</p>
                    <ul>
                        <li>Practice phone numbers</li>
                        <li>Named GP contacts</li>
                        <li>Out-of-hours arrangements</li>
                        <li>Community team contacts</li>
                    </ul>
                    <span class="arrow">View contacts &rarr;</span>
                </a>

                <a href="referral.html" class="portal-card">
                    <div class="portal-card-icon">&#x1F4E8;</div>
                    <h3>Make a Referral</h3>
                    <p>Submit a new referral to the EnRICH service for a care home resident.</p>
                    <span class="arrow">Go to referral form &rarr;</span>
                </a>

                <a href="team.html" class="portal-card blue">
                    <div class="portal-card-icon">&#x1F465;</div>
                    <h3>Meet the Team</h3>
                    <p>View the EnRICH team members and their contact details.</p>
                    <span class="arrow">View team &rarr;</span>
                </a>

                <a href="https://mjb302.github.io/enrich-map/" target="_blank" class="portal-card teal">
                    <div class="portal-card-icon">&#x1F5FA;&#xFE0F;</div>
                    <h3>Interactive Map</h3>
                    <p>View enrolled care homes on our interactive map of Cambridgeshire.</p>
                    <span class="arrow">Open map &rarr;</span>
                </a>
            </div>

            <div class="quick-links">
                <h3>&#x26A1; Quick Links</h3>
                <div class="quick-links-grid">
                    <a href="cga.html" class="quick-link">CGA Information</a>
                    <a href="acp.html" class="quick-link">Advance Care Planning</a>
                    <a href="medications-conditions.html" class="quick-link">Medication Reviews</a>
                    <a href="acute-deterioration.html" class="quick-link">Acute Deterioration</a>
                    <a href="staff-education.html" class="quick-link">Staff Education</a>
                    <a href="mdt-collaboration.html" class="quick-link">MDT Collaboration</a>
                    <a href="resources.html" class="quick-link">External Resources</a>
                </div>
            </div>

            <div class="logout-section">
                <button class="logout-btn" id="logout-btn">&#x1F512; Lock Portal &amp; Clear Session</button>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2026 EnRICH - Enhanced Reviews in Care Homes<br>Cambridge University Hospitals NHS Foundation Trust</p>
            <p><a href="resources.html">Resources</a> | <a href="https://mjb302.github.io/enrich-map/" target="_blank">Interactive Map</a></p>
        </div>
    </footer>

    <script>
        // =============================================
// EnRICH PIN Hash Map
// Generated: 01/02/2026
// Paste this into: team.html, referral.html, staff-portal.html
// Replace the existing var careHomePINs = { ... };
// =============================================

var careHomePINs = {
    // --- Care Homes (31) ---
    'fe24aa89e33d228cb577bbb4e711915b06afe4ad2a490963e5df25c9842c20e2': 'Alex Wood House',
    '3bee6539d1067e8f68bed995929d064d7305b5d270ceff2f8e9d35a899acd37d': 'Bramley Court',
    'f9b612674f3f0acfd4a3d81dcfc2e5d5b7060f8a21be33de7536d1af33b71830': 'Brook House Care Home',
    'aee73965b29b99f53a3db9504ea2b208c0c018c217fdf15e553e955855953900': 'Cambridge Grove Care Home',
    '8f2034cfc80faa1621c4d416654243d15498b7eafa3cf8147675e36665313579': 'Cambridge Manor Care Home',
    '2d3f2d14c058e044a774908508ed37b9f1b47ffbd519e1e4b1717c489910a096': 'Cleves Place',
    '47a3ed983a9127f210c339e591f65506b9cfc127ce1d2cf5f3a26927369e7ddf': 'Cottenham Court Care Home',
    'af8b17e81b1a3801e5e770de0a1a1f43e770030f98fe67221453fdbdd6b1affe': 'Etheldred House Care Home',
    '7edd1a06302c6e71fefb576021cf632d694775c1343b6222bce9cafa08ebbb13': 'Fitzwilliam House Care Home',
    'da5c2f49fad2615edf210b93a0408cbb762cc42880e98452fa8a2b5b6ae631f3': 'Hatley Court',
    '41751ff4c81c502af385eee954b2612b13936e393186543deb80b320407993c8': 'Heathlands House',
    'd0dca67d8153e8e39f456e5f0441f84b41936cd5149d213ee733b3067e6f82f7': 'Highfield Care Home',
    '80b3383fc7df188f00b97aa5b0625054b193c9cd3a8d261e654bc4e38149c760': 'Hilton Park - Oaklands',
    'cd3d20333ca6d04a1f234e9807cc74a028350a671b49c0cc9a026cb5a1d9b00d': 'Home Close',
    '9de02e2a1338c710c7f09d1aeee4142a2b1f9e0c554d29ab9a7be6cbb7008aa9': 'Home Meadow',
    'd75ce5017561e791495b3e007ead8697b27e277cd9882b2262e0de66d6d1f12e': 'Langdon House',
    '7599b6dd1963f67bc1335b85bbf0b7ad38d81034cc3fc5b69d2327e8b3d3a067': 'Lily House',
    'f0eed60c335b758b7dbf29308262a8ff638e46de5ee38b79d77994fab5231c05': 'Maycroft Care Home',
    '18555c2d2c9e8c63d085dc91c61044bfa9f13696209a8110a744feda7645079e': 'Melbourn Springs Care Home',
    'c9ab187dc9a3366dd148631ef1b508d55f37f98e15d33801d65fcedc76ff865b': 'Melwood Grange',
    'f67445e4610f525afd0a733e5cc4993c329546a1f97392cf8943ee8c49a5f339': 'Midfield Lodge',
    '1b6b1543dc6c1d432ae5735f9be6b64ac122672114330ac29226d65acc581bd2': 'Orchard House Residential Care Home',
    '8a661929534d66b23ab23c9d7899587221c5eccab66ed61ba17a5163d91ea5f8': 'Primrose Croft Care Home',
    '6c0865de8b4a8183318369d4f04b06cbf422a29daf4f7a7a45f776c20e6d523d': 'Queens Court',
    '3197b1d4f9cb468f58533c516079011b3a6ac205e600d118ee823a31d3808c25': 'Southwell Court',
    '77450960dfed2bba6594e0f4c712e28cd19fb93ae61a383015354edc22a3ff8a': 'Symonds House',
    '87874556d2abe6ee84d5aa4a69124d6f05afcf8c1b50e18eddc57ba367f30bdd': 'The Cambridgeshire Care Home',
    'ed36a326dbeded94e927c06fa922d4207cee5cad1f650d7f30ca4553f348a0e8': 'Townsend Manor',
    '7a16fd6a5ae1529960527e825cd32ec769aa118e3273cb562e5f316539aff3ae': 'Vera James House',
    '2fa697315db830fcf1136c0d0dfa87e5fa039f5e611a6aa07947d4769ce252e2': 'Waterbeach Lodge',
    '81c73f02bbe4878ec04ac472e5e70718db0948303f697749685897d4b86db5d7': 'Woodlands Care Centre',

    // --- Staff (1) ---
    '7604f82270c4fdb3b99db9550468a26fe02a35073e1e12eb784f2dc8fc745199': 'Matt Butler',
};
        async function hashPIN(pin) {
            var encoder = new TextEncoder();
            var data = encoder.encode(pin);
            var hashBuffer = await crypto.subtle.digest('SHA-256', data);
            var hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(function(b) { return b.toString(16).padStart(2, '0'); }).join('');
        }

        var pinInputs = document.querySelectorAll('.pin-digit');

        pinInputs.forEach(function(input, index) {
            input.addEventListener('input', function(e) {
                var value = e.target.value;
                if (!/^\d*$/.test(value)) { e.target.value = ''; return; }
                if (value && index < pinInputs.length - 1) { pinInputs[index + 1].focus(); }
                if (index === pinInputs.length - 1 && value) { validatePIN(); }
            });
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Backspace' && !e.target.value && index > 0) { pinInputs[index - 1].focus(); }
                if (e.key === 'Enter') { validatePIN(); }
            });
            input.addEventListener('paste', function(e) {
                e.preventDefault();
                var pastedData = e.clipboardData.getData('text').replace(/\D/g, '').slice(0, 5);
                pastedData.split('').forEach(function(digit, i) { if (pinInputs[i]) { pinInputs[i].value = digit; } });
                if (pastedData.length === 5) { pinInputs[4].focus(); validatePIN(); }
            });
        });

        document.getElementById('validate-btn').addEventListener('click', validatePIN);
        document.getElementById('logout-btn').addEventListener('click', logout);

        async function validatePIN() {
            var pin = Array.from(pinInputs).map(function(input) { return input.value; }).join('');
            var errorMsg = document.getElementById('pin-error');
            if (pin.length !== 5) { errorMsg.style.display = 'block'; errorMsg.textContent = 'Please enter all 5 digits.'; return; }
            var hash = await hashPIN(pin);
            if (careHomePINs[hash]) {
                var homeName = careHomePINs[hash];
                try { sessionStorage.setItem('enrich_auth', 'true'); sessionStorage.setItem('enrich_home', homeName); } catch(e) {}
                showPortal(homeName);
                errorMsg.style.display = 'none';
            } else {
                errorMsg.style.display = 'block';
                errorMsg.textContent = 'Invalid PIN code. Please check and try again.';
            }
        }

        function showPortal(homeName) {
            document.getElementById('pin-entry').style.display = 'none';
            document.getElementById('portal-content').style.display = 'block';
            document.getElementById('care-home-name').textContent = homeName;
        }

        function logout() {
            try { sessionStorage.removeItem('enrich_auth'); sessionStorage.removeItem('enrich_home'); } catch(e) {}
            document.getElementById('pin-entry').style.display = 'block';
            document.getElementById('portal-content').style.display = 'none';
            pinInputs.forEach(function(input) { input.value = ''; });
            pinInputs[0].focus();
        }

        // Auto-unlock if already authenticated this session
        (function() {
            try {
                if (sessionStorage.getItem('enrich_auth') === 'true') {
                    var homeName = sessionStorage.getItem('enrich_home') || 'Authenticated';
                    showPortal(homeName);
                }
            } catch(e) {}
        })();
    </script>
</body>
</html>
